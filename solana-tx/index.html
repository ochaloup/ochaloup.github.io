<!DOCTYPE html>
<html>
<head>
  <title>Solana base64 transaction deserializer</title>
  <script defer="defer" src="./dist/bundle.js"></script>
</head>
<body>
  <h1>Solana base64 transaction deserializer</h1>
  
    <textarea type="text" id="messageInput" placeholder="Enter base64 transaction here" rows="15" cols="100"></textarea>
    <br/>
    <input list="clusters" name="cluster" id="cluster" placeholder="https://api.devnet.solana.com" size="40" onclick="document.getElementById('cluster').value=''">
    <datalist id="clusters">
        <option value="https://api.devnet.solana.com">
        <option value="https://api.mainnet-beta.solana.com">
        <option value="https://api.testnet.solana.com">
    </datalist>
    <br/>
    <button id="submitButton" onclick="handleDisplayMessage()">Show deserialized format</button>
  
    <hr/>
    <p id="messageOutput"></p>
  
    <script>
        let params = new URL(document.location).searchParams;
        let message = params.get("message");
        if (message) {
          const decodedMessage = window.decodeURIComponent(message);
          document.getElementById("messageInput").value = decodedMessage;
        }
        let cluster = params.get("cluster");
        if (cluster) {
          const decodedCluster = window.decodeURIComponent(cluster);
          document.getElementById("cluster").value = decodedCluster;
        }

        async function handleDisplayMessage() {
          let searchParams = ''
          let message = document.getElementById("messageInput").value;
          if (message) {
            searchParams = 'message=' + window.encodeURIComponent(message);
          }
          let cluster = document.getElementById("cluster").value;
          if (cluster) {
            if (searchParams) {
              searchParams += '&';
            }
            searchParams += 'cluster=' + window.encodeURIComponent(cluster);
          }
          window.history.replaceState(undefined, document.title, window.location.pathname + "?" + searchParams);
          await scriptNamespace.deserializeTransaction();
        }
      </script>

  <footer style="position:fixed; bottom:0; height:auto; margin-top:40px; width:100%; text-align:center; font-size: 80%;">
    <p style="text-align: right; margin-right: 30px;">Tested with Chrome 113, thanks to <a href="https://github.com/solana-labs/oyster/tree/main/packages/governance-sdk">SPL Governance SDK</a>
    and <a href="https://github.com/debridge-finance/solana-tx-parser-public">Debridge finance SDK</a></p>
  </footer>
</body>
</html>